<html>
  <head>
    <style>
      .slidecontainer { width: 100%; }
      .slider {
        -webkit-appearance: none;
        width: 100%;
        height: 25px;
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
      }
      .slider:hover { opacity: 1; }
      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        background: #FF0000;
        cursor: pointer;
      }
      .slider::-moz-range-thumb {
        width: 25px;
        height: 25px;
        background: #FF0000;
        cursor: pointer;
      }
    </style>
  </head>
  <body onload="setup()">
      <script src="FL64.js" type="text/javascript"></script>
      <script type="text/javascript">
        //inputs and outputs.
        
        var out = inV = cmp1 = cmp2 = undefined;
        var rn = [];

        //Input value and constants.

        var v1=4.4508568202988705, v2=v1**2, v3=v1**3, v4=v1**4, a = [];

        var g2d = undefined, cv = undefined;

        //Setup the main outputs.

        function setup()
        {
          rn[0] = document.getElementById("r1");
          rn[1] = document.getElementById("r2");
          rn[2] = document.getElementById("r3");
          rn[3] = document.getElementById("r4");
          out = document.getElementById("val");
          inV = document.getElementById("inVal");
          cmp1 = document.getElementById("c1");
          cmp2 = document.getElementById("c2");
          cv = document.getElementById("maps");
          g2d = cv.getContext("2d");

          update();
        }

        //Create maps allowing us to build faster better algorithms.

        function map2D()
        {
          var d1 = cmp1.value, d2 = cmp2.value;

          var o = 0, v = [v4,v3,v2,v1], r = [r1.value,r2.value,r3.value,r4.value];

          var mat = [], t1 = 0, t2 = 0;

          for(var i1 = 0; i1 < 100; i1++)
          {
            mat[i1] = []; for(var i2 = 0;i2 < 100; i2++)
            {
              if(d1 != d2) { r[d1] = i1; r[d2] = i2; }
              else { r[d1] = Math.max(i1,i2); }

              o = Math.abs(v[0]*r[0] - v[1] * r[1] - v[2] * r[2] - v[3] * r[3]);

              t1 = (o-Math.floor(o)); if(t1>=0.5){t1=1-t1;} t1=1/t1;

              if( t1 > 0x7fff ){ t1 = 0x7fff; } mat[i1][i2] = t1;
            }
          }

          var gd = g2d.createImageData(cv.width, cv.height);
          var d = gd.data;

          for(var x=0,p=0,c=0;x<100;x++)
          {
            for(var y=0;y<100;y++)
            {
              c=Math.round((mat[x][y]/0x7fff)*0xffffff);
              d[p]=c&0xff;d[p+1]=(c>>8)&0xff;d[p+2]=(c>>16)&0xff;
              d[p+3]=255;p+=4;
            }
          }

          g2d.putImageData(gd, 0, 0);
        }

        //Change the value.

        function change()
        {
          v1=parseFloat(inV.value); v2=v1**2;v3=v1**3;v4=v1**4;
        }

        //Update inputs and outputs.

        function update()
        {
          a = [rn[0].value,rn[1].value,rn[2].value,rn[3].value];
          a.push(v4*a[0]-v3*a[1]-v2*a[2]-v1*a[3]);
          out.innerHTML = a + "<br />[" + [v4,v3,v2,v1] + "]";map2D();

          var v = [392.44110936280026,88.17203635331686,19.81012643480097,4.4508568202988705];

          //2,7,2,9 v0 to v3.

          var a = v[0]*2-v[1]*7-v[2]*2, b = v[3];

          /*We can find what to multiply by to result in a whole number
          by converting to a fraction. However what is missing is
          finding what to multiply by that results in a whole number relative
          to another.
          0.75 - 0.95*?
          Answer is 5.
          Now if this was 0.75 - 0.25*? we know 25 fits 3 times and the solution is 3.
          In the example above 95 fits to a whole number
          but the result is -4 as a whole number.
          We can't just divide
          0.75 / 0.95 = 0.7894736842 = 15 / 19
          to find number of times it fits like we did
          with 0.75 / 0.25 = 3. To solve this as a 
          division we would have to do 4.75 / 0.95 = 5.
          The extra 4 times into the number allows us
          to solve how it fits. In the case we actually
          do not know what to raise the value by it
          becomes a guess. We do not want or like
          guesses at all.
          */

          var v1 = a, v2 = b;

          var c1 = v1-(v1&-1), c2 = v2-(v2&-1);

          var x=(c2).splitAll().calcF(0);
          var y=(c1).splitAll().calcF(0);

          out.innerHTML = c2*x.y;//[v1-v2*x];
        }

        function adj()
        {
          var d1 = cmp1.value, d2 = cmp2.value;
          if(d1!=d2)
          {
            rn[d2].value=Math.floor((this.event.offsetX/cv.clientWidth)*100);
            rn[d1].value=Math.floor((this.event.offsetY/cv.clientHeight)*100);
          }
          else
          {
            rn[d1].value=Math.max(Math.floor((this.event.offsetX/cv.clientWidth)*100),Math.floor((this.event.offsetY/cv.clientHeight)*100));
          }
          update(true);
        }
      </script>
      <input type="text" value="4.4508568202988705" onkeypress="if(event.keyCode==13){change();}" id="inVal" /> = <div style="display:inline-block;" id="val"></div>
      <div class="slidecontainer">
        <hr />
        <input type="range" min="1" max="100" value="2" class="slider" id="r1" oninput="update();"><hr />
        <input type="range" min="0" max="100" value="7" class="slider" id="r2" oninput="update();"><hr />
        <input type="range" min="0" max="100" value="2" class="slider" id="r3" oninput="update();"><hr />
        <input type="range" min="0" max="100" value="9" class="slider" id="r4" oninput="update();">
      </div>
      <canvas id="maps" width="100px;" height="100px;" style="image-rendering:pixelated;width:100%;" onclick="adj()"></canvas>
      <div class="slidecontainer"><hr />
        X:<input type="range" min="0" max="3" value="0" class="slider" id="c1" oninput="map2D();"><hr />
        Y:<input type="range" min="0" max="3" value="0" class="slider" id="c2" oninput="map2D();"><hr />
      </div>
  </body>
</html>