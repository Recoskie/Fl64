<html>
<head>
  <title>IEEE-754 Float 64 library.</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-title" content="FL64">
  <meta name="viewport" content="width=device-width, minimum-scale=0.5, maximum-scale=0.5, initial-scale=0.5, user-scalable=no" id="vp" />
  <link rel="apple-touch-icon" href="https://repository-images.githubusercontent.com/81086272/73a9ee80-65f9-11ea-9cd9-3c14b7503cff">
  <meta property="og:image" content="https://repository-images.githubusercontent.com/81086272/73a9ee80-65f9-11ea-9cd9-3c14b7503cff" />
</head>
<body onload="update(); Trans.update(); LoadExample();">
  <style type="text/css">
    <!--
    body
    {
      background-color: #000000;
      background-image: url(bg/bg.jpg);
      background-repeat: no-repeat;
      background-size: cover;
      -moz-background-size: cover;
      -webkit-background-size: cover;
    }

    table
    {
      background-color: rgba(200,200,200,0.50);
    }

    input[type=button]
    {
      background-color: rgba(0, 200, 255, 0.50);
    }

    input[type=text]
    {
      background-color: rgba(255, 255, 255, 0.50);
    }
    
    .cc
    {
      position: fixed;
      left: 0px;
      right: 0px;
      top: 0px;
      bottom: 0px;
      z-index: 1;
      background: rgba(40, 40, 40, 0.80);
    }

   .cg
   {
     position: absolute;
     width: 100%;
     height: 100%;
     left: 0px;
     top: 0px;
     z-index: 1;
    }
    -->
  </style>
  <div id="g" class="cc" onclick="this.hidden = true;" hidden="true">
    <canvas width="1294" height="800" id="gr" class="cg"></canvas>
  </div>
  <script src="../FL64.js" type="text/javascript"></script>
  <script src="../FL64-UI.js" type="text/javascript"></script>
  <script src="https://recoskie.github.io/AI-Matrix/AI-Mat.js" type="text/javascript"></script>
  <script type="text/javascript">
    //Body onresize dose not always get called on ios.
    
    var mobile = !isNaN( window.orientation ), eventVP = true;
    
    function resetVP()
    {
      document.getElementById("vp").content = "initial-scale=0.5, user-scalable=yes";
      
      document.removeEventListener("touchstart", resetVP);
      
      eventVP = true;
    }
    
    if( mobile )
    {
      window.onorientationchange = update;
    }
    else
    {
      window.onresize = update;
    }
    
    //Cf is default Algorithm.
    
    var alg = -2;

    //Graphics area used for adjusting width and height and visabilty.

    var gar = document.getElementById("gr");
    
    //Graphics object for plotting data.
    
    var g2d = gar.getContext("2d");
    
    //If vertical or horzontal.
    
    var hr = true;
    
    //Setup convergent bar.

    var CVerg = new CBar("CVerg");

    //Set up Control/Edit factor bar.

    var Fracts = new FBar("Fracts");

    //Setup factor transformation bar.

    var Trans = new TBar("Trans", Fracts);

    /*A floating point number is incomplete at it's last digit of accuracy.
    Thus this creates factors that are partially incomplete*/

    var ac = 100; //Percentage as an adjustable value.
    var CutOff = 1 / Math.pow(2, (52 * (ac / 100))); //The actual cut off range across the binary number.

    //Number compared against to test accuracy.

    var n_ac = NaN;

    //User input.

    function GetInput()
    {
      var n = NaN;

      if (input == 1)
      {
        n = new Fract(document.getElementById("f1").value, document.getElementById("f2").value);
      }
      else
      {
        n = new Number(document.getElementById("num").value);
      }

      if (isNaN(n) || Math.abs(n) == Infinity) { alert("Please enter a Number value, or Fraction to split."); }

      else
      {
        n_ac = n;
        
        CVerg.set(n.primitive().splitAll());
        
        Fracts.set((alg <= 0 ? n_ac : alg == 1 ? new FNumber(n_ac) : new TNumber(n_ac)).splitAll());
      }
    }

    //Switch div elements between cell and row alignment based on window dimensions.

    function update()
    {
      if( mobile && eventVP )
      {
        document.getElementById("vp").content="width=device-width, minimum-scale=0.5, maximum-scale=0.5, initial-scale=0.5, user-scalable=no";
        
        document.addEventListener("touchstart", resetVP, eventVP = false);
      }
      
      var ng = document.getElementById("group");
      var w = window.innerWidth, h = window.innerHeight;

      //If width is longer do regular row alignment.
      
      hr = mobile ? Math.abs(window.orientation) != 90 : w < h;

      if (CVerg.Vertical && !hr) { ng.innerHTML = "<div id=\"CVerg\" style=\"width:100%;overflow:hidden;\"></div><hr /><div id=\"Fracts\" style=\"width:100%;overflow:hidden;\"></div>"; gar.width=1294; gar.height=800; }

      //Else lay the bars out side by side in cells.

      else if (!CVerg.Vertical && hr) { ng.innerHTML = "<table style='height:61%;'><tr><td style='height:100%;'><div id=\"CVerg\" style=\"height:100%;overflow:hidden;\"></div></td><td style='height:100%;'><div id=\"Fracts\" style=\"height:100%;overflow:hidden;\"></div></td></tr></table>"; gar.height=1294; gar.width=800; }

      //Update the page elements b1, and b2 to proper width and dimensions.
      
      CVerg.auto(); Fracts.auto();
    
      //Replot the canvas.

      if( document.getElementById('g').hidden == false ) { plot(); }
    }

    //Update the convergent bar on creating a new number in FBar.

    Fracts.onCreate = function (n)
    {
      //Update n_ac number.

      if( input == 1 && alg <= 0 ) { n_ac = n.calcF(); } else { n_ac = n.calc(); }
      
      //Update input/output.
      
      n = n_ac.splitAll();

      CVerg.set(n); this.set(alg <= 0 ? n.limit(CutOff) : (alg == 1 ? new FNumber(n_ac) : new TNumber(n_ac)).limit(CutOff).splitAll());

      //Change to number type only.

      UpdateI();
    }

    //Update output and accuracy comparison.

    Fracts.onChange = function (n)
    {
      //Calculate the accuracy of the value to the Cut off range.

      var re = Math.ceil((((-Math.log(Math.abs(1 - (n.primitive() / n_ac.primitive()))) / Math.log(2)) / (52 / (100 / ac))) * 100));

      if (re == Infinity || re > 100) { re = 100; }

      document.getElementById("r-ac").innerHTML = isNaN(re) ? "?" : re;

      //Update output to change.

      document.getElementById("r").innerHTML = n + "";
    }

    //Load an example.
    
    var sq = 2, tanh = 3, pat = 1;

    function LoadExample(type)
    {
      var sing = type < 0 ? -1 : 1, type = Math.abs(type) || 0;
      
      if( alg <= 0 )
      {
        if (type == 0)
        {
          document.getElementById("Exp").innerHTML = alg == -2 ? "<table border='1'><tr><td rowspan='2'>Load Example:</td>\
<td><input type='button' value='Golden Ratio' onclick='LoadExample(1);' /><input type='button' value='-Golden Ratio' onclick='LoadExample(-1);' /></td>\
<td><input type='button' value='Natural LOG' onclick='LoadExample(2);' /><input type='button' value='-Natural LOG' onclick='LoadExample(-2);' /></td>\
<td><input type='button' value='&radic;"+ sq + "' onclick='LoadExample(4);' /><input type='button' value='-&radic;"+ sq + "' onclick='LoadExample(-4);' />\
<input type='button' value='&#x2191;' onclick='sq++;LoadExample();' /><input type='button' value='&#x2193;' onclick='sq=Math.max(1,sq-1);LoadExample();' /></td></tr>\
<tr><td><input type='button' value='Pattern " + pat + "' onclick='LoadExample(6);' /><input type='button' value='-Pattern " + pat + "' onclick='LoadExample(-6);' />\
<input type='button' value='&#x2191;' onclick='pat++;LoadExample();' /><input type='button' value='&#x2193;' onclick='pat=Math.max(1,pat-1);LoadExample();' /></td>\
<td><input type='button' value='tanh(1 &div; "+ tanh + " )' onclick='LoadExample(5);' /><input type='button' value='-tanh(1 &div; "+ tanh + " )' onclick='LoadExample(-5);' />\
<input type='button' value='&#x2191;' onclick='tanh++;LoadExample();' /><input type='button' value='&#x2193;' onclick='tanh=Math.max(1,tanh-1);LoadExample();' /></td>\
<td><input type='button' value='PI' onclick='LoadExample(3);' /><input type='button' value='-PI' onclick='LoadExample(-3);' /></td></table>" : "";
        }
        else
        {
          //Solve the golden ratio.

          if (type == 1)
          {
            var n = ( 1.618033988749895 * sing ).limit(CutOff); if (input == 1) { n = n.getFract(); }

            n_ac = n.primitive(); CVerg.set(n.splitAll());

            n = n.split(); Fracts.set(n);

            Trans.index = 0; Trans.set([sing], [1]);
          }

          //Solve the natural logarithm.

          else if (type == 2)
          {
            var n = ( 2.718281828459045 * sing ).limit(CutOff); if (input == 1) { n = n.getFract(); }

            n_ac = n.primitive(); CVerg.set(n.splitAll());

            n = n.setA(0, 2 * sing); Fracts.set(n);

            Trans.index = 1; Trans.set([sing, sing], [1, 1]);
          }

          //Solve the number PI.

          else if (type == 3)
          {
            var n = ( Math.PI * sing ).limit(CutOff); if (input == 1) { n = n.getFract(); }

            n_ac = n.primitive(); CVerg.set(n.splitAll());

            n = n.setA(0, 3 * sing); Fracts.set(n);

            Trans.index = 1; Trans.set([6 * sing, 0, 0], [9, 16, 8]);
          }

          //Solve a Square root.

          else if (type == 4)
          {
            var n = ( Math.pow(sq, 0.5) * sing ).limit(CutOff); if (input == 1) { n = n.getFract(); }

            n_ac = n.primitive(); CVerg.set(n.splitAll());

            var a = Math.floor(n.primitive() * sing), b = sq - (a * a);

            n.length = 0;

            if ((n - a) !== 0) {
              n = n.split(a * sing, b); Fracts.set(n);

              Trans.index = 1; Trans.set([a * 2 * sing], [b]);
            }
            else { Fracts.set(n); Trans.index = 1; Trans.set(); }
          }

          //Solve the hyperbolic function.

          else if (type == 5)
          {
            var n = ( Math.tanh(1 / tanh) * sing ).limit(CutOff); if (input == 1) { n = n.getFract(); }

            n_ac = n.primitive();

            CVerg.set(n.splitAll());

            n = n.setA( 0, 0 ); Fracts.set(n);

            Trans.index = 1; Trans.set([tanh * sing, tanh * 2 * sing ], [1, 0]);
          }
        
          //Solve base 10 irrational pattern.
          //Note we can do the same operation in binary, or hexadecimal.
      
          else if (type == 6)
          {
            var base = 10;
          
            dif = Math.floor(Math.log(pat)/Math.log(base));
          
            for( var n1 = dif, n2 = 0, n = 0; n1 < 6; n1++, n2 += n1 ) { n += Math.pow(base, -n2) * pat; }
        
            n = n * sing; if (input == 1) { n = n.getFract(); }
            
            n = n.limit(CutOff);

            n_ac = n.primitive();

            CVerg.set(n.splitAll());
            
            n = n.setA(0, pat * sing); n = n.setB(0, pat);
            n = n.setA(1, base * sing); n = n.setB(1, -base);
            
            Fracts.set(n);
            
            eval("var a = function(x)\r\n{\r\n  return( " + (sing < 0 ? "-" : "") + "Math.pow( " + base + ", x + 1 ) " + (sing < 0 ? "-" : "+") + " 1 );\r\n}, b = function(x)\r\n{\r\n return( -Math.pow( " + base + ", x + 1 ) );\r\n}");
            
            Trans.index = 2; Trans.setF(a,b);
          }
        }
      }
      else if( alg == 1 )
      {
        if (type == 0)
        {
          document.getElementById("Exp").innerHTML = "<table border='1'><tr><td>Load Example:</td><td><input type='button' value='Natural LOG' onclick='LoadExample(1);' /><input type='button' value='-Natural LOG' onclick='LoadExample(-1);' /></td><td><input type='button' value='PI' onclick='LoadExample(2);' /><input type='button' value='-PI' onclick='LoadExample(-2);' /></td></table>";
        }
        
        //Solve the natural logarithm.

        if (type == 1)
        {
          ac = 44; setAC();
            
          n = new FNumber( 2.718281828459045 * sing ).limit(CutOff);

          n_ac = n.primitive();

          CVerg.set(n.splitAll());
            
          Fracts.set(n);
            
          eval("var a = function(x)\r\n\{\r\n\  return(x);\r\n\}; var b = function(x)\r\n\{\r\n\  for(var i = 0, pf = 1; i < x; pf*=(++i));\r\n\  return( pf );\r\n\};");
            
          Trans.index = 0; Trans.setF(a,b);
        }
          
        //Solve the number PI.

        if (type == 2)
        {
          ac = 44; setAC();
          
          n = new FNumber(Math.PI * sing).limit(CutOff);

          n_ac = n.primitive();
          
          CVerg.set(n.primitive().splitAll()); 
          
          Fracts.set(n);

          Trans.index = 0; Trans.set([8,0,0],[3,32,32]);
        }
      }
      else if( alg == 2 )
      {
        if (type == 0)
        {
          document.getElementById("Exp").innerHTML = "<table border='1'><tr><td>Load Example:</td><td><input type='button' value='PI' onclick='LoadExample(1);' /><input type='button' value='-PI' onclick='LoadExample(-1);' /></td></table>";
        }
        else
        {
          //Solve the number PI.

          if (type == 1)
          {
            ac = 44; setAC();
          
            n = new TNumber(Math.PI * sing).limit(CutOff);

            n_ac = n.primitive();
          
            CVerg.set(n.primitive().splitAll()); 
          
            Fracts.set(n);

            Trans.index = 0; Trans.set([4,0],[1,2]);
          }
        }
      }

      //Update input type.

      UpdateI();
    }

    //Adjust the cut off range and accuracy.

    function setAC()
    {
      CutOff = 1 / Math.pow(2, (52 * (ac / 100)));

      if (!isNaN(Fracts.get())) { Fracts.set(Fracts.get().limit(CutOff)); }

      document.getElementById("ac").innerHTML = ac + "";
    }
    
    function changeAlg(s)
    {
      alg = s - 2; cfAdj(alg == -1 || alg == 0, alg == 0);
      Fracts.update(true); Trans.reset();
      
      if( !isNaN(n_ac) )
      {
        n_ac = n_ac.primitive();
        
        if( alg <= 0 )
        {
          Fracts.set((input == 0 ? new Number(n_ac) : new Fract(n_ac.x, n_ac.y)).limit(CutOff).splitAll());
        }
        else
        {
          Fracts.set((alg == 1 ? new FNumber(n_ac) : new TNumber(n_ac)).limit(CutOff).splitAll());
        }
      }
      else
      {
        Fracts.set(alg <= 0 ? n_ac : alg == 1 ? new FNumber(n_ac) : new TNumber(n_ac));
      }
      
      update(); LoadExample();
    }

    //Change the input method.

    var input = 0;

    function UpdateI(i)
    {
      input = i || input;
      var x = "Number Value", y = "Number Value";

      if (input == 1)
      {
        if (!isNaN(n_ac))
        {
          if( !n_ac.x ) { n_ac = n_ac.primitive().getFract(); }
          x = n_ac.x; y = n_ac.y;
        }

        document.getElementById("in").innerHTML = '<input id="f1" type="text" value="' + x + '" onclick="this.select();">&div;<input id="f2" type="text" value="' + y + '" onclick="this.select();">';
      }
      else
      {
        document.getElementById("in").innerHTML = '<input type="text" style="width:75%;" id="num" value="' + ( isNaN(n_ac) ? x : n_ac ) + '" onclick="this.select();">';
      }
    }
    
    function plot()
    {
      document.getElementById("g").hidden = false;
      
      var f = Fracts.get();

      //min/max value in set A and B.

      var amx = f.a[0], amn = f.a[0];
      var bmx = f.b[0], bmn = f.b[0];

      for( var i = 1; i < f.length; i++ )
      {
        if( amx < f.a[i] ){ amx = f.a[i]; }
        if( amn > f.a[i] ){ amn = f.a[i]; }
        if( bmx < f.b[i] ){ bmx = f.b[i]; }
        if( bmn > f.b[i] ){ bmn = f.b[i]; }
      }

      //Range of movement in set A and B.

      var arng = amx - amn;
      var brng = bmx - bmn;

      //begin the plotting function.
      
      g2d.beginPath();
      
      var fc = (f.length-1)/1252;
      
      g2d.strokeStyle = "#00FF00";
      g2d.fillStyle = "#0000FF"
      g2d.font = "40px Arial";
      g2d.lineWidth = 3;
      
      if( hr )
      {
        //Draw rects.
        
        g2d.clearRect(0,0,800,1294);
        g2d.strokeRect(0,0,400,1294);
        g2d.strokeRect(400,0,400,1294);
        g2d.strokeRect(0,0,400,40);
        g2d.strokeRect(400,0,400,40);
        
        g2d.fillText("A", 185, 35);
        g2d.fillText("B", 585, 35);
        
        g2d.stroke();
        
        //Plot

        g2d.strokeStyle = "#FF0000";
        
        var aCenter = amx - (arng / 2);
        var axc = -198.5 / (aCenter - amn);
        var bCenter = bmx - (brng / 2);
        var bxc = -198.5 / (bCenter - bmn);

        if( !isFinite(axc) ){ axc = 1; }
        if( !isFinite(bxc) ){ bxc = 1; }
      
        g2d.moveTo((200.5+((aCenter - f.a[0])*axc))&-1,41);
      
        for(var i = 1, p = 0; i < 1252; p=(fc*(i++)+0.5)&-1 )
        {
          g2d.lineTo((200.5+((aCenter - f.a[p])*axc))&-1,i+41);
        }
      
        g2d.moveTo(600.5+(((bCenter - f.b[0])*bxc))&-1,41);
      
        for(var i = 1, p = 0; i < 1252; p=(fc*(i++)+0.5)&-1 )
        {
          g2d.lineTo((600.5+((bCenter - f.b[p])*bxc))&-1,i+41);
        }
      }
      else
      {
        //Draw rects.

        g2d.clearRect(0,0,1294,800);
        g2d.strokeRect(40,0,1254,400);
        g2d.strokeRect(40,400,1254,400);
        g2d.strokeRect(0,0,40,400);
        g2d.strokeRect(0,400,40,400);
        
        g2d.fillText("A", 5, 215);
        g2d.fillText("B", 5, 615);
        
        g2d.stroke();
        
        //Plot
        
        g2d.strokeStyle = "#FF0000";
        
        var aCenter = amx - (arng / 2);
        var axc = 198.5 / (aCenter - amn);
        var bCenter = bmx - (brng / 2);
        var bxc = 198.5 / (bCenter - bmn);

        if( !isFinite(axc) ){ axc = 1; }
        if( !isFinite(bxc) ){ bxc = 1; }
      
        g2d.moveTo(41,(200.5+((aCenter - f.a[0])*axc))&-1);
      
        for(var i = 1, p = 0; i < 1252; p=(fc*(i++)+0.5)&-1 )
        {
          g2d.lineTo(i+41,(200.5+((aCenter - f.a[p])*axc))&-1);
        }
      
        g2d.moveTo(41,(600.5+((bCenter - f.b[0])*bxc))&-1);
      
        for(var i = 1, p = 0; i < 1252; p=(fc*(i++)+0.5)&-1 )
        {
          g2d.lineTo(i+41,(600.5+((bCenter - f.b[p])*bxc))&-1);
        }
      }
      
      g2d.stroke(); g2d.closePath();
    }
    
    function reset()
    {
      var n = alg <= 0 ? NaN : alg == 1 ? new FNumber() : new TNumber();
      
      Fracts.set(n); Trans.reset();
      
      CVerg.set(n.primitive());
      
      n_ac = n.primitive();
      
      update(); UpdateI();
    }
  </script>
  <center>
    <table style="width:100%;" border="1">
      <tr>
        <td>
          <center>Algorithm</center>
        </td>
        <td>
          <center>Input Type</center>
        </td>
        <td>
          <input type="button" value="X" style="width:25%;" onclick="reset();" /><div style="display:inline;" id="in"><input type="text" style="width:75%;" id="num" value="Number Value" onclick="this.select();"></div>
        </td>
        <td>
          <center>Cut Off Range</center>
        </td>
        <td>
          <center>Output</center>
        </td>
        <td>
          <center>Accuracy</center>
        </td>
        <td rowspan="2">
          <center><input type="button" onclick="plot();" value="Plot" /></center>
        </td>
      </tr>
      <tr>
        <td>
          <select onchange="changeAlg(this.value);" style="width:100%;">
            <option value="0">Cf</option>
            <option value="1">Cf(A=A)</option>
            <option value="2">Cf(A=A,B>=B)</option>
            <option value="3">Tf</option>
            <option value="4">Tf(-\+)</option>
          </select>
        </td>
        <td>
          <select onchange="UpdateI(this.value);" style="width:100%;">
            <option value="0">Value</option>
            <option value="1">Fraction</option>
          </select>
        </td>
        <td>
          <input type="button" style="width:100%;" value="Split Value." onclick="GetInput();">
        </td>
        <td>
          <center><input type="button" value="&#x2191;" onclick="ac=Math.min(ac+1,100);setAC();" /><div style="display:inline;" id="ac">100</div>%<input type="button" value="&#x2193;" onclick="ac=Math.max(ac-1,1);setAC();" /></center>
        </td>
        <td>
          <center><div id="r">?</div></center>
        </td>
        <td>
          <center><div style="display:inline;" id="r-ac">?</div>%</center>
        </td>
      </tr>
    </table>
    <div id="group">
      <div id="CVerg" style="overflow:hidden;"></div>
      <hr />
      <div id="Fracts" style="overflow:hidden;"></div>
    </div>
    <hr />
    <div id="Trans" style="max-height:30%;"></div>
    <br />
    <div id="Exp"></div>
  </center>
</body>
</html>
