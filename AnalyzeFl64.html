<html>
  <body>
    <script src="FL64.js" type ="text/javascript"></script>
    <script type="Text/JavaScript">

    function FractAnalyze()
    {
      var num1 = null, num2 = null, str = "";
      
      try
      {
        num1 = parseInt( document.getElementById("f1").value, 10 );
      }
      catch( e ) { num1 = NaN; }
      
      try
      {
        num2 = parseInt( document.getElementById("f2").value, 10 );
      }
      catch( e ) { num2 = NaN; }
      
      if( num1 === null || num2 === null || isNaN( num1 ) || isNaN( num2 ) )
      {
        if( document.getElementById("f1").value === "" || document.getElementById("f2").value === "" )
        {
          str += "Enter numbers to divide by.";
        }
        else if( isNaN(num1) )
        {
          str += document.getElementById("f1").value+" = Is not an number.";
        }
        else if( isNaN(num2) )
        {
          str += document.getElementById("f2").value+" = Is not an number.";
        }
      }
      else
      {
        str = "<h1>Accurate simulated divide.</h1>"
        
        //Display data in an nice table.
        
        str += "<table border=\"1\">";
        
        //Show the fraction to be divided.
        
        str += "<tr><td>Division:</td><td> " + num1 + "&divide;" + num2 + "</td></tr>";
        
        //Find the Division pattern.
        
        var Data = DivToPat( num1, num2 );
        
        //Show the bit pattern.
        
        str += "<tr><td>Divide Bit Pattern:</td><td>" + Data + "</td></tr>";
        
        //Convert the pattern into the predicted representation of the floats mantissa bit's.
        
        str += "<tr><td>Bit Pattern to Binary Number:</td><td>" + PatToBin( Data ) + "," + PatToBin( Data ) + ",&infin;" + "</td></tr>";
        
        //Convert the bit pattern into divide.
        
        var n1 = null, n2 = null;
        var n = PatToDiv( Data );
        
        n1 = n[0]; n2 = n[1];
        
        var Float = num1 / num2;
        
        if( n1 !== 0 && n2 !== 0 )
        {
          str += "<tr><td>Decode bit pattern back to ?/? = pat:</td><td>" + n1 + "&divide;" + n2 + "</td></tr>";
          
          //Compute Nominator.
          
          var e = Float / (n1/n2); n1 *= e;
          
          //Display most reduced fraction.
          
          str += "<tr><td>Smallest fraction:</td><td>" + n1 + "&divide;" + n2 + "</td></tr>";
        }
        else if( Data[0] === null ) { str += "<tr><td>Warning:</td><td>No bit pattern to translate.</td></tr>"; }
        else { str += "<tr><td>Warning:</td><td>Bit pattern is too big and out of range.</td></tr>"; }
        
        str += "</table>";
      
        //**********************************************************************************
        //Divide the fraction for real, and decode the real mantissa.
        //**********************************************************************************
        
        str += "<h3>Actual divide using JavaScript Float64 Format.</h3>";
        str += "<table border=\"1\">";
        
        //Decode native Float64 format.
        
        var Float = num1 / num2;
        
        var fl64 = DecodeFloat( Float );
        
        str += "<tr><td>Float Value:</td><td>" + Float + "</td></tr>";
        str += "<tr><td>Sing:</td><td>" + fl64[0] + "</td></tr>";
        str += "<tr><td>Exponent:</td><td>" + ToBin( fl64[1], 11 ) + "</td></tr>";
        str += "<tr><td>Mantissa:</td><td>" + ToBin( fl64[2], 52 ) + "</td></tr>";
        
        //Convert the Mantissa into it's bit pattern count.
        
        str += "<tr><td>Float Mantissa Bit pattern count:</td><td>" + BitCount( DecodeMantissa( Float ) ) + "</td></tr>";
        str += "</table>";
      }
      
      document.getElementById("out").innerHTML = str;
    }
    
    </script>

    <center>
      <table border="1">
        <tr><td>Analyze Float64 Fractions.</td></tr>
        <tr>
          <td>Fract: <input type="text" id="f1" />&divide;<input type="text" id="f2" /><input type="button" value="Analyze Fraction." onclick="FractAnalyze();" / ></td>
        </tr>
      </table>

      <div id="out">
      </div>
      
    </center>

  </body>
</html>
